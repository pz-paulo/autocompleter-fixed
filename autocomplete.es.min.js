/**
 * Copyright (c) 2016 Denis Taran
 *
 * Homepage: https://smartscheduling.com/en/documentation/autocomplete
 * Source: https://github.com/denis-taran/autocomplete
 *
 * MIT License
 */
function e(e){var t=document,n=e.container||t.createElement("div"),i=e.preventSubmit||0;n.id=n.id||"autocomplete-"+E();var r,o,a=n.style,c=e.debounceWaitMs||0,s=e.disableAutoSelect||!1,u=n.parentElement,l=[],d="",f=2,v=e.showOnFocus,p=0,m=!1,b=!1;if(void 0!==e.minLength&&(f=e.minLength),!e.input)throw new Error("input undefined");var g=e.input;function E(){return Date.now().toString(36)+Math.random().toString(36).substring(2)}function h(){var e=n.parentNode;e&&e.removeChild(n)}function A(){o&&window.clearTimeout(o)}function w(){return!!n.parentNode}function L(){p++,l=[],d="",r=void 0,g.setAttribute("aria-activedescendant",""),g.setAttribute("aria-expanded","false"),h()}function x(){n.textContent="",g.setAttribute("aria-activedescendant","");var i=function(e,n,i){var r=t.createElement("div");return r.textContent=e.label||"",r};e.render&&(i=e.render);var o=function(e,n){var i=t.createElement("div");return i.textContent=e,i};e.renderGroup&&(o=e.renderGroup);var c=t.createDocumentFragment(),s=E();if(l.forEach((function(t,a){if(t.group&&t.group!==s){s=t.group;var u=o(t.group,d);u&&(u.className+=" group",c.appendChild(u))}var l=i(t,d,a);l&&(l.id=n.id+"_"+a,l.setAttribute("role","option"),l.addEventListener("click",(function(n){b=!0;try{e.onSelect(t,g)}finally{b=!1}L(),n.preventDefault(),n.stopPropagation()})),t===r&&(l.className+=" selected",l.setAttribute("aria-selected","true"),g.setAttribute("aria-activedescendant",l.id)),c.appendChild(l))})),n.appendChild(c),l.length<1){if(!e.emptyMsg)return void L();var f=t.createElement("div");f.id=n.id+"_"+E(),f.className="empty",f.textContent=e.emptyMsg,n.appendChild(f),g.setAttribute("aria-activedescendant",f.id)}n.parentNode||(u||t.body).appendChild(n),function(){if(w()){g.setAttribute("aria-expanded","true"),a.height="auto",a.width=g.offsetWidth+"px";var i,r=0;o(),o(),e.customize&&i&&e.customize(g,i,n,r)}function o(){var e=t.documentElement,n=e.clientTop||t.body.clientTop||0,o=e.clientLeft||t.body.clientLeft||0,c=window.pageYOffset||e.scrollTop,s=window.pageXOffset||e.scrollLeft,u=(i=g.getBoundingClientRect()).top+g.offsetHeight+c-n,l=i.left+s-o;a.top=u+"px",a.left=l+"px",(r=window.innerHeight-(i.top+g.offsetHeight))<0&&(r=0),a.top=u+"px",a.bottom="",a.left=l+"px",a.maxHeight=r+"px"}}(),N()}function y(){w()&&x()}function T(){y()}function k(e){e.target!==n?y():e.preventDefault()}function C(){b||M(0)}function N(){var e=n.getElementsByClassName("selected");if(e.length>0){var t=e[0],i=t.previousElementSibling;if(i&&-1!==i.className.indexOf("group")&&!i.previousElementSibling&&(t=i),t.offsetTop<n.scrollTop)n.scrollTop=t.offsetTop;else{var r=t.offsetTop+t.offsetHeight,o=n.scrollTop+n.offsetHeight;r>o&&(n.scrollTop+=r-o)}}}function O(e){l.length>0&&(!function(e){var i=t.getElementById(n.id+"_"+e);i&&(i.classList.remove("selected"),i.removeAttribute("aria-selected"),g.removeAttribute("aria-activedescendant"))}(e),function(e){var i=t.getElementById(n.id+"_"+e);i&&(i.classList.add("selected"),i.setAttribute("aria-selected","true"),g.setAttribute("aria-activedescendant",i.id))}(l.indexOf(r)),N())}function D(e,t){var n,i=w();if("Escape"===t)L();else{if(!i||l.length<1)return;"ArrowUp"===t?(n=l.indexOf(r),r=-1===n?void 0:l[(n+l.length-1)%l.length],O(n)):function(){var e=l.indexOf(r);r=l.length<1?void 0:-1===e?l[0]:l[(e+1)%l.length],O(e)}()}e.preventDefault(),i&&e.stopPropagation()}function S(t){var n=t.key;switch(n){case"ArrowUp":case"ArrowDown":case"Escape":D(t,n);break;case"Enter":!function(t){if(r){2===i&&t.preventDefault(),b=!0;try{e.onSelect(r,g)}finally{b=!1}L()}1===i&&t.preventDefault()}(t)}}function H(){v&&M(1)}function M(e){g.value.length>=f||1===e?(A(),o=window.setTimeout((function(){return P(g.value,e,g.selectionStart||0)}),0===e||2===e?c:0)):L()}function P(t,n,i){if(!m){var o=++p;e.fetch(t,(function(e){p===o&&e&&(d=t,r=(l=e).length<1||s?void 0:l[0],x())}),n,i)}}function z(t){e.keyup?e.keyup({event:t,fetch:function(){return M(0)}}):w()||"ArrowDown"!==t.key||M(0)}function B(t){e.click&&e.click({event:t,fetch:function(){return M(2)}})}function U(){setTimeout((function(){var e;console.log("[AUTOCOMPLETER] doc.ActiveElement",t.activeElement),console.log("[AUTOCOMPLETER] container",n),t.activeElement!==g&&t.activeElement!==n&&(null===(e=t.activeElement)||void 0===e?void 0:e.parentElement)!==n&&L()}),200)}return n.className=[n.className,"autocomplete",e.className||""].join(" ").trim(),n.setAttribute("role","listbox"),g.setAttribute("role","combobox"),g.setAttribute("aria-expanded","false"),g.setAttribute("aria-autocomplete","list"),g.setAttribute("aria-controls",n.id),g.setAttribute("aria-owns",n.id),g.setAttribute("aria-activedescendant",""),g.setAttribute("aria-haspopup","listbox"),a.position="absolute",n.addEventListener("mousedown",(function(e){e.stopPropagation(),e.preventDefault()})),n.addEventListener("focus",(function(){return g.focus()})),h(),g.addEventListener("keyup",z),g.addEventListener("click",B),g.addEventListener("keydown",S),g.addEventListener("input",C),g.addEventListener("blur",U),g.addEventListener("focus",H),window.addEventListener("resize",T),t.addEventListener("scroll",k,!0),{destroy:function(){g.removeEventListener("focus",H),g.removeEventListener("keyup",z),g.removeEventListener("click",B),g.removeEventListener("keydown",S),g.removeEventListener("input",C),g.removeEventListener("blur",U),window.removeEventListener("resize",T),t.removeEventListener("scroll",k,!0),g.removeAttribute("role"),g.removeAttribute("aria-expanded"),g.removeAttribute("aria-autocomplete"),g.removeAttribute("aria-controls"),g.removeAttribute("aria-activedescendant"),g.removeAttribute("aria-owns"),g.removeAttribute("aria-haspopup"),A(),L(),m=!0},fetch:function(){P(g.value,3,g.selectionStart||0)}}}export default e;
//# sourceMappingURL=autocomplete.es.min.js.map
